# 富文本编辑器设计

## 问题点1  渲染使用什么实现

这两者前提都是有ast数据，dom是走什么渲染方式生成。

1. 使用 vue render 做渲染
2. 使用 innerHTML 或者 vue的 v-html/ domPropsInnerHTML 做渲染


这二者是二选1的，我以为 vue render 是更理想、纯粹、干净、现代化的方式。

这要求我们需要严格保证单向数据流，不允许用户对dom任何改动，因为这都会导致渲染不符合预期，vue的diff是对vm，而不是对dom，好在拦截所有对dom的变更是可行的。

不足是我们需要自己实现 拖拽 、粘贴等等事件。

## 问题点2 以什么数据为准

1. 以 html dom 结构为准
2. 以 ast data 结构为准

使用 vue render方案，则必须要以ast data为准。


## 问题2.2  其实上述两个问题说到底就是以ast数据为准还是以 dom 为准。

以ast数据为准，有更多的自由性。

以dom 为准，可能会出现更多不符合预期的情况出现。

## 问题点3 dom刷新后恢复焦点

可以确定的是，改变焦点，不可避免要对原生dom操作。



## 如何理解展示异常

展示异常，是并非vue的渲染处理有什么不当，并非vue的diff机制问题。

注意，contenteditable交互取决于浏览器，dom上表现为浏览器会增加一些dom，这些dom不被vue渲染机制管理和发现，于是vue在渲染时又创建了相应的dom，所以会出现多出dom元素的问题。

要想从根本解决这个问题，只能去拦截掉浏览器所有对dom的修改，让渲染只来自于ast数据。

